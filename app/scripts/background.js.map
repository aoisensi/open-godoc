{"version":3,"sources":["../scripts.babel/background.js"],"names":[],"mappings":"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","file":"background.js","sourcesContent":["'use strict';\n\nvar services = {\n  'github.com': (pathes) => {\n    var pkg = () => {\n      if (pathes.length < 3) {\n        return null;\n      }\n      var ignores = ['issues', 'pulls', 'explore', 'settings', 'blog', 'account'];\n      if (ignores.indexOf(pathes[1]) !== -1) {\n        return null;\n      }\n      var pkg = ['github.com'];\n      [].push.apply(pkg, pathes.slice(1, 3));\n      if (pathes.length === 3) {\n        return pkg;\n      }\n      switch (pathes[3]) {\n        case 'tree':\n          [].push.apply(pkg, pathes.slice(5));\n          return pkg;\n        case 'blob':\n          [].push.apply(pkg, pathes.slice(5, -1));\n          return pkg;\n      }\n      return pkg;\n    }();\n    if (pkg === null) {\n      return null;\n    }\n    if (pkg.length >= 5 &&\n        pkg[1] === 'golang' &&\n        pkg[2] === 'go' &&\n        pkg[3] === 'src' &&\n        pkg[4] !== 'cmd'\n      ) {\n        pkg = pkg.slice(4);\n    }\n    return pkg.join('/');\n  }\n};\n\nfunction parse(urls, doit) {\n  var url = new URL(urls);\n  var service = services[url.hostname];\n  if (service === undefined) {\n    return null;\n  }\n  var path = url.pathname;\n  if (path === null) {\n    return;\n  }\n  var pathes = path.split('/');\n  //remove last slash\n  if (pathes[-1] === '') {\n    pathes = pathes.slice(0, -1);\n  }\n  var name = service(pathes);\n  if (name === null) {\n    return;\n  }\n  //Can i stop showing 404 error console message?\n  var xhr = new XMLHttpRequest();\n  xhr.open('HEAD', 'http://godoc.org/' + name);\n  xhr.onloadend = () => {\n    if (xhr.status === 200) {\n      doit(name);\n    }\n  };\n  xhr.send();\n}\n\nchrome.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {\n  parse(tab.url, () => {\n    chrome.pageAction.show(tabId);\n  });\n});\n\nchrome.pageAction.onClicked.addListener(tab => {\n  parse(tab.url, (pkg) => {\n    var url = 'http://godoc.org/' + pkg;\n    chrome.tabs.create({ url: url });\n  });\n});\n"]}